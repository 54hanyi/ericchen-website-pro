---
title: "MDX ç­†è¨˜ç³»çµ±é–‹ç™¼è¡€æ·šå²ï¼šå¾ import åˆ° compileMDX"
description: "è¨˜éŒ„æˆ‘å¦‚ä½•å¾å‚³çµ± import æ¨¡çµ„ï¼Œè½‰æˆç”¨ compileMDX è§£æ Frontmatterï¼Œè§£æ±º Next.js App Router çš„å‘ã€‚"
tags: ["next.js", "MDX", "compileMDX", "App Router", "è¡€æ·šå²"]
date: "2025-06-02"
---

# MDX ç­†è¨˜ç³»çµ±é–‹ç™¼è¡€æ·šå²ï¼šå¾ `import` åˆ° `compileMDX`

---

æ‰“é€ è‡ªå·±çš„ **MDX ç­†è¨˜ç³»çµ±**ï¼Œä¸€ç›´æ˜¯æˆ‘çš„ç›®æ¨™ã€‚

é€™æ¬¡è¨˜éŒ„ä¸‹é€™æ®µé–‹ç™¼éç¨‹ä¸­ï¼Œå¾è¸©å‘åˆ°è§£æ±ºå•é¡Œçš„è¡€æ·šæ­·ç¨‹ï¼Œé †ä¾¿ä½œç‚ºæœªä¾†çš„è‡ªå·±æˆ–ä»–äººåƒè€ƒã€‚

---

## ğŸš© å•é¡ŒèƒŒæ™¯

åŠŸèƒ½éœ€æ±‚ï¼š

- ç­†è¨˜åˆ—è¡¨èƒ½é¡¯ç¤ºæ‰€æœ‰ç­†è¨˜
- æ¯ç¯‡ç­†è¨˜èƒ½é»é€²å»ç€è¦½è©³ç´°å…§å®¹
- æ”¯æ´ **ä¸Šä¸€ç¯‡ / ä¸‹ä¸€ç¯‡** å¿«é€Ÿç€è¦½
- æ¯ç¯‡ç­†è¨˜éœ€æœ‰ `title`ã€`description`ã€`tags`ã€`date` ç­‰æ¬„ä½

---

## ğŸš« ä¸€é–‹å§‹æ¡ç”¨çš„åšæ³•

ç•¶æ™‚çš„ç­†è¨˜æª”æ¡ˆæ ¼å¼æ˜¯é€™æ¨£ï¼š

```tsx
export const metadata = {
  title: "æ·±å…¥ç†è§£ useEffect",
  description: "é€™ç¯‡æ–‡ç« å¸¶ä½ ä¸€æ¬¡é‡æ¸… useEffect çš„æ‰€æœ‰ä¾è³´é™·é˜±èˆ‡æ­£ç¢ºç”¨æ³•ã€‚",
  tags: ["react", "useEffect", "hook"],
  date: "2024-05-26",
};
```

æ­é…é€™æ¨£çš„å‹•æ…‹ import æ–¹å¼è¼‰å…¥ï¼š

```tsx
const post = await import(`../${params.slug}/page.mdx`);
```

---

## âš ï¸ é‡åˆ°çš„å•é¡Œ

é€™ç¨®åšæ³•åœ¨ Next.js App Router (`next 13/14/15`) + RSC ç’°å¢ƒä¸‹é‡åˆ°è‡´å‘½å•é¡Œï¼š

- âŒ **RSC ä¸å…è¨± `import()` å‹•æ…‹è®€å–æª”æ¡ˆ**
- âŒ `params` æ˜¯ Async çš„ï¼Œå–å€¼éœ€è¦ `await`
- âŒ `import()` æœƒè®“ build å¡æ­»ï¼Œç„¡æ³•é æ¸²æŸ“
- âŒ metadata ç„¡æ³•æ­£ç¢ºè®€å–ï¼Œç­†è¨˜åˆ—è¡¨å‡ºç¾ç©ºç™½

---

## ğŸš‘ è§£æ³• â€” æ”¹ç”¨ `compileMDX`

1. **æ”¹ç”¨ `next-mdx-remote/rsc`**  
   å®˜æ–¹æ¨è–¦çš„æ–°åšæ³•ï¼Œé€é `compileMDX` ä¾†è§£æ MDXï¼š

```tsx
import { compileMDX } from "next-mdx-remote/rsc";

const { frontmatter } = await compileMDX({
  source: file,
  options: { parseFrontmatter: true },
});
```

é€™æ¨£å¯ä»¥ï¼š

- âœ… ç›´æ¥è§£æ Frontmatter
- âœ… æ”¯æ´ RSC
- âœ… ç„¡éœ€å‹•æ…‹ `import`ï¼Œé¿å… build å¡æ­»

2. **èª¿æ•´ MDX æ ¼å¼**

ç­†è¨˜æª”æ¡ˆæ”¹ç”¨ YAML Frontmatterï¼Œæ ¼å¼è®Šæˆé€™æ¨£ï¼š

````mdx
---
title: "Next.js åœ–ç‰‡ç„¡æ³•é¡¯ç¤ºçš„è§£æ³•"
description: "éƒ¨ç½²å¾Œåœ–ç‰‡ä¸è¦‹ï¼Ÿä½ éœ€è¦åŠ ä¸Š image domainsï¼"
tags: ["next.js", "image", "deploy", "bug"]
date: "2024-05-25"
---

# Next.js åœ–ç‰‡ç„¡æ³•é¡¯ç¤ºçš„è§£æ³•

éƒ¨ç½²å¾Œåœ–ç‰‡ä¸è¦‹ï¼Ÿé€šå¸¸æ˜¯å› ç‚ºä½ æ²’è¨­å®š `images.domains`ã€‚

```js
images: {
  domains: ["images.unsplash.com"],
}
```
````

````

---

## ğŸ”¨ ä¿®æ”¹ `getAllNotes`

éæ­·è³‡æ–™å¤¾ `data/notes/{slug}/page.mdx`ï¼Œæ¯å€‹æª”æ¡ˆç”¨ `compileMDX` è§£æ Frontmatterï¼š

```tsx
const { frontmatter } = await compileMDX({
  source: file,
  options: { parseFrontmatter: true },
});
````

ä¸¦æ•´ç†æˆé€™å€‹å‹åˆ¥ï¼š

```tsx
type NoteMeta = {
  slug: string;
  title: string;
  description: string;
  tags?: string[];
  date?: string;
};
```

å†ä¾ç…§ `date` æ’åºï¼Œè®“æœ€æ–°çš„æ–‡ç« é¡¯ç¤ºåœ¨æœ€å‰é¢ã€‚

---

## ğŸ”§ ä¿®æ”¹ `generateMetadata`

ä¸å†ç”¨ `import()`ï¼Œç›´æ¥å¾ MDX Frontmatter å–è³‡æ–™ï¼š

```tsx
const { frontmatter } = await compileMDX({
  source,
  options: { parseFrontmatter: true },
});

return {
  title: frontmatter.title,
  description: frontmatter.description,
};
```

---

## ğŸ‰ æœ€çµ‚æˆæœ

- âœ… ç­†è¨˜åˆ—è¡¨æ­£ç¢ºé¡¯ç¤º `title`ã€`description`
- âœ… ç­†è¨˜å…§å®¹æ¸²æŸ“æ­£å¸¸
- âœ… ä¸Šä¸€ç¯‡ã€ä¸‹ä¸€ç¯‡é€£çµé †åˆ©é‹ä½œ
- âœ… ç­†è¨˜æ•¸é‡å¯ä»¥çµ±è¨ˆ

---

## âœï¸ å°çµ

é€™æ¬¡çš„è¸©å‘èˆ‡ä¿®æ­£è®“æˆ‘çœŸæ­£ç†è§£ **App Router** çš„é™åˆ¶ï¼Œä»¥åŠ **MDX** èˆ‡ **Frontmatter** çš„è™•ç†æ–¹å¼ã€‚

å¦‚æœä½ ä¹Ÿæƒ³è‡ªå·±åšä¸€å¥—å°å‹éƒ¨è½æ ¼æˆ–ç­†è¨˜ç³»çµ±ï¼Œå¸Œæœ›é€™ä»½ç­†è¨˜å°ä½ æœ‰å¹«åŠ©ï¼
