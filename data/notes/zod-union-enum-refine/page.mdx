---
title: 'Zod #4ï¼šUnionã€Enumã€Literal èˆ‡ Refine å¯¦æˆ°'
description: 'ä»‹ç´¹ Zod ä¸­é€²éšæ¢ä»¶å‹åˆ¥ï¼šunionã€enumã€literalã€refineï¼Œè‡ªå®šç¾©é‚è¼¯èˆ‡æ¢ä»¶é©—è­‰ã€‚'
tags: ['zod', 'typescript', 'union', 'enum', 'refine']
date: '2025-06-17'
---

# ğŸ“˜ Zod #4ï¼šUnionã€Enumã€Literal èˆ‡ Refine å¯¦æˆ°

Zod æ”¯æ´è¤‡é›œå‹åˆ¥é‚è¼¯ï¼ŒåŒ…æ‹¬å¤šç¨®å¯èƒ½å€¼ã€å›ºå®šå€¼ã€åˆ—èˆ‰ã€æ¢ä»¶è½‰æ›èˆ‡è‡ªè¨‚éŒ¯èª¤ã€‚é€™ä¸€ç« æœƒæ•™ä½ å››ç¨®é€²éšæŠ€å·§ï¼š

## ğŸ” unionï¼šå¤šç¨®å¯èƒ½å‹åˆ¥ï¼ˆäºŒé¸ä¸€ã€å¤šé¸ä¸€ï¼‰

```ts
const schema = z.union([z.string(), z.number()]);

schema.parse('hello'); // âœ… OK
schema.parse(42); // âœ… OK
schema.parse(true); // âŒ éŒ¯èª¤ï¼šboolean ä¸åœ¨ union ä¸­
```

> ğŸ“Œ ä¹Ÿå¯ä»¥ç”¨ `.or()` å¯«æ³•ï¼š`z.string().or(z.number())`

## ğŸ”¢ literalï¼šé™åˆ¶æŸæ¬„ä½åªèƒ½æ˜¯æŸå€‹å›ºå®šå€¼

```ts
const schema = z.literal('admin');

schema.parse('admin'); // âœ…
schema.parse('user'); // âŒ éŒ¯èª¤
```

## ğŸŒ enumï¼šé™åˆ¶å€¼å¿…é ˆæ˜¯åˆ—èˆ‰ä¸­çš„å…¶ä¸­ä¸€å€‹

```ts
const roleSchema = z.enum(['admin', 'user', 'guest']);

roleSchema.parse('admin'); // âœ…
roleSchema.parse('root'); // âŒ éŒ¯èª¤
```

### ğŸ”„ æ‹¿ enum å‹åˆ¥ç•¶æˆ TypeScript é¡å‹

```ts
type Role = z.infer<typeof roleSchema>; // 'admin' | 'user' | 'guest'
```

## ğŸ§  refineï¼šåŠ å…¥è‡ªå®šç¾©é‚è¼¯é©—è­‰

```ts
const passwordSchema = z
  .string()
  .min(6)
  .refine((val) => /[A-Z]/.test(val), {
    message: 'å¯†ç¢¼è‡³å°‘è¦åŒ…å«ä¸€å€‹å¤§å¯«è‹±æ–‡å­—æ¯',
  });
```

- `.refine(fn, message)`ï¼šç”¨ä¾†å¯«ä»»ä½•è‡ªè¨‚é‚è¼¯
- `fn` å›å‚³ true â†’ é©—è­‰æˆåŠŸï¼Œfalse â†’ å¤±æ•—
- message æœƒå›å‚³éŒ¯èª¤æç¤º

## ğŸ”’ superRefineï¼šå¯ä»¥è·¨å¤šå€‹æ¬„ä½è‡ªè¨‚é‚è¼¯

```ts
const schema = z
  .object({
    password: z.string(),
    confirm: z.string(),
  })
  .superRefine((val, ctx) => {
    if (val.password !== val.confirm) {
      ctx.addIssue({
        path: ['confirm'],
        message: 'å…©æ¬¡å¯†ç¢¼ä¸ä¸€è‡´',
        code: z.ZodIssueCode.custom,
      });
    }
  });
```

> `superRefine()` é©åˆåœ¨ object ä¸­åšã€Œè·¨æ¬„ä½æª¢æŸ¥ã€

## âœ… å°çµ

- `union([...])`ï¼šå…è¨±å¤šç¨®å‹åˆ¥
- `literal('å›ºå®šå€¼')`ï¼šåªèƒ½æ˜¯é€™å€‹å€¼
- `enum([...])`ï¼šåˆ—èˆ‰ä¸­çš„ä»»ä¸€å€‹
- `refine(fn)`ï¼šå¯«ä¸€å€‹æ¬„ä½çš„è‡ªè¨‚é©—è­‰é‚è¼¯
- `superRefine(fn)`ï¼šè·¨æ¬„ä½é©—è­‰ï¼Œåšæ›´è¤‡é›œé‚è¼¯

ğŸ‘‰ ä¸‹ä¸€ç« ï¼Œæˆ‘å€‘æœƒå­¸ç¿’å¦‚ä½•æŠŠ Zod schema èˆ‡ TypeScript å‹åˆ¥äº’è½‰ã€æŠ½å‡ºå…±ç”¨å‹åˆ¥ï¼
