---
title: 'Zustand æ•™å­¸ï¼šå¾å…¥é–€åˆ°å¸¸ç”¨æŠ€å·§'
description: 'æ•´ç† Zustand çš„ä½¿ç”¨æ¦‚å¿µã€ç¯„ä¾‹ã€å¸¸è¦‹æ–¹æ³•èˆ‡æ‡‰ç”¨æƒ…å¢ƒï¼Œè®“ä½ å¿«é€ŸæŒæ¡ React ç‹€æ…‹ç®¡ç†æ–°å¯µã€‚'
tags: ['zustand', 'state-management', 'React']
date: '2025-06-17'
---

# ğŸ» Zustand æ•™å­¸ï¼šå¾å…¥é–€åˆ°å¸¸ç”¨æŠ€å·§

Zustand æ˜¯ä¸€å€‹è¼•é‡åˆå¼·å¤§çš„ React ç‹€æ…‹ç®¡ç†å‡½å¼åº«ï¼Œä¸éœ€ Providerã€ä¸å¯« reducerï¼Œä¹Ÿèƒ½éˆæ´»è™•ç†å…¨åŸŸç‹€æ…‹ã€‚

## âœ… 1. Zustand æ˜¯ä»€éº¼ï¼Ÿ

Zustand æ˜¯ä¸€å€‹ç”¨ä¾†ç®¡ç† React ä¸­**å…±äº«ç‹€æ…‹**çš„å·¥å…·ï¼š

- âœ… æ²’æœ‰ Providerï¼Œä½¿ç”¨ç°¡å–®
- âœ… æ”¯æ´ä¸­å¤§å‹æ‡‰ç”¨åˆ‡ç‰‡ç®¡ç†ï¼ˆsliceï¼‰
- âœ… æ”¯æ´ persist å„²å­˜åˆ° localStorage
- âœ… æ”¯æ´ Devtoolsã€middleware æ“´å……

## ğŸš€ 2. å®‰è£

```bash
npm install zustand
```

## ğŸ“¦ 3. å»ºç«‹ storeï¼ˆåŸºæœ¬ç¯„ä¾‹ï¼‰

```ts
import { create } from 'zustand';

type BearStore = {
  count: number;
  increase: () => void;
};

export const useBearStore = create<BearStore>((set) => ({
  count: 0,
  increase: () => set((state) => ({ count: state.count + 1 })),
}));
```

## ğŸ§ª 4. åœ¨å…ƒä»¶ä¸­ä½¿ç”¨

```tsx
function BearCounter() {
  const count = useBearStore((s) => s.count);
  const increase = useBearStore((s) => s.increase);

  return (
    <div>
      <p>ç›®å‰ç†Šçš„æ•¸é‡æ˜¯ {count}</p>
      <button onClick={increase}>å¢åŠ ä¸€éš»ç†Š</button>
    </div>
  );
}
```

## ğŸ”§ 5. å¸¸ç”¨ API

| æ–¹æ³•                 | èªªæ˜                         |
| -------------------- | ---------------------------- |
| `create(fn)`         | å»ºç«‹ä¸€å€‹ store               |
| `set(fn)`            | è¨­å®šæ–°ç‹€æ…‹                   |
| `get()`              | å–å¾—ç›®å‰ç‹€æ…‹å€¼               |
| `subscribe()`        | è¨‚é–±ç‹€æ…‹è®ŠåŒ–ï¼ˆéå…ƒä»¶ç”¨ï¼‰     |
| `useStore(selector)` | åœ¨å…ƒä»¶ä¸­å–å€¼ï¼ˆå¯é¿å…é‡æ¸²æŸ“ï¼‰ |

## ğŸ§© 6. åˆ‡ç‰‡ï¼ˆSliceï¼‰ç®¡ç†å¤šç‹€æ…‹

```ts
// authSlice.ts
export const createAuthSlice = (set) => ({
  user: null,
  login: (user) => set({ user }),
  logout: () => set({ user: null }),
});
```

```ts
// store.ts
import { create } from 'zustand';
import { createAuthSlice } from './authSlice';

export const useStore = create()((...a) => ({
  ...createAuthSlice(...a),
}));
```

## ğŸ’¾ 7. ä½¿ç”¨ persist å„²å­˜ç™»å…¥è³‡è¨Š

```ts
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

export const useAuthStore = create(
  persist(
    (set) => ({
      user: null,
      login: (user) => set({ user }),
      logout: () => set({ user: null }),
    }),
    {
      name: 'auth-storage', // localStorage çš„ key
    }
  )
);
```

## ğŸ§  8. å¯¦æˆ°ï¼šç™»å…¥åŠŸèƒ½ store

```ts
// loginStore.ts
import { create } from 'zustand';

type LoginState = {
  username: string;
  isLoggedIn: boolean;
  login: (name: string) => void;
  logout: () => void;
};

export const useLoginStore = create<LoginState>((set) => ({
  username: '',
  isLoggedIn: false,
  login: (name) => set({ username: name, isLoggedIn: true }),
  logout: () => set({ username: '', isLoggedIn: false }),
}));
```

```tsx
// LoginForm.tsx
const login = useLoginStore((s) => s.login)
<button onClick={() => login('Eric')}>ç™»å…¥</button>
```

```tsx
// UserInfo.tsx
const { username, isLoggedIn, logout } = useLoginStore();
```

## ğŸ§  Zustand é©ç”¨æƒ…å¢ƒ

- âœ… **ç™»å…¥è€…è³‡æ–™å…±äº«**ï¼šéå¸¸æ¨è–¦ä½¿ç”¨ Zustand
- âœ… **modal / sidebar ç‹€æ…‹æ§åˆ¶**ï¼šè¼•å·§åˆå¥½ç”¨
- âœ… **è³¼ç‰©è»Šç‹€æ…‹ / æ”¶è—æ¸…å–®**ï¼šæ¨è–¦ä½¿ç”¨ Zustand ç®¡ç†
- âŒ **è¡¨å–®æ¬„ä½è¼¸å…¥ç‹€æ…‹**ï¼šä¸å»ºè­°ï¼Œç”¨ `useState` æ›´ç›´è¦º
- âŒ **Server API è³‡æ–™**ï¼šè«‹ä½¿ç”¨ React Queryï¼ˆæ›´æ“…é•·è™•ç†è³‡æ–™åŒæ­¥èˆ‡å¿«å–ï¼‰
